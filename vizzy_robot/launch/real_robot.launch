<?xml version="1.0"?>
<launch>
	<!-- Camera parameters -->
	<arg name="left_camera_name" default="l_camera" />
	<arg name="right_camera_name" default="r_camera" />
	<arg name="left_camera_guid" default="00b09d01007ad691" />
	<arg name="right_camera_guid" default="00b09d01007ad693" />
  	<arg name="video_mode" default="640x480_rgb8" />
  	<arg name="frame_rate" default="10.0" />

	<arg name="map_frame" default="map" />
  	<arg name="map_service" default="/static_map" />
	<arg name="map_topic" default="/map" />

  	<arg name="throttle_rate" default="0.5" />

	<!-- launch the map server for the simulated world -->
  	<include file="$(find vizzy_robot)/launch/vizzy_world_map_server.launch" />

	<!-- set the tf prefix as necessary -->
	<arg name="ns" default="" />
	<arg name="tf_prefix" default="$(arg ns)" />
	<arg name="device_id" default="#1" />
	<param name="tf_prefix" value="$(arg tf_prefix)" />

	<arg name="base_frame_id" default="$(arg tf_prefix)/base_footprint" />
  	<arg name="odom_frame_id" default="$(arg tf_prefix)/odom" />

	<!-- launch the auxiliary configuration (shared between h/w and simulation) -->
	<include file="$(find vizzy_robot)/launch/auxiliary.vizzy.launch.xml">
		<arg name="tf_prefix" value="$(arg tf_prefix)" />
		<arg name="use_yarp" value="true" />
	</include>

	<!-- launch the segway base -->
  	<include file="$(find vizzy_robot)/launch/segway_base.launch" />

  	<!-- launch the hokuyo sensor -->
	<include file="$(find vizzy_robot)/launch/hokuyo.launch">
	    <arg name="name" value="nav_hokuyo" />
	    <arg name="tf_prefix" value="$(arg tf_prefix)" />
	    <!-- <arg name="publish_tf" value="false" /> already published by urdf -->
	</include>

	<!-- launch the laser filter to get rid of readings from the robot itself -->
  	<include file="$(find vizzy_sensors)/launch/hokuyo/hokuyo-filters.launch" />

	<!--<node name="fake_localization" pkg="fake_localization" type="fake_localization">
	    <remap from="base_pose_ground_truth" to="odom"/>
	    <param name="global_frame_id" value="$(arg map_frame)" />
	    <param name="base_frame_id" value="$(arg base_frame_id)" />
	    <param name="odom_frame_id" value="$(arg odom_frame_id)" />
	</node>-->
        <include file="$(find vizzy_navigation)/launch/amcl.launch">
  	</include>

	<include file="$(find vizzy_navigation)/launch/move_base_eband.launch">
    	<arg name="map_topic" value="$(arg map_topic)" />
  	</include>

 	<!-- Left camera -->
	<include file="$(find vizzy_robot)/launch/camera.launch">
    		<arg name="camera" value="$(arg left_camera_name)" />
    		<arg name="guid" value="$(arg left_camera_guid)" />
  		<arg name="video_mode" value="$(arg video_mode)" />
  		<arg name="frame_rate" value="$(arg frame_rate)" />
	</include>

 	<!-- Right camera -->
	<include file="$(find vizzy_robot)/launch/camera.launch">
    		<arg name="camera" value="$(arg right_camera_name)" />
    		<arg name="guid" value="$(arg right_camera_guid)" />
  		<arg name="video_mode" value="$(arg video_mode)" />
  		<arg name="frame_rate" value="$(arg frame_rate)" />
  		<arg name="throttle_rate" default="$(arg throttle_rate)" />
	</include>

 	<!-- Pedestrian Detector -->
	<include file="$(find pedestrian_detector)/launch/pedestrian_detector.launch">
    		<arg name="image_in" value="$(arg right_camera_name)/image_raw" />
	</include>


</launch>
